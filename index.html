const express = require("express");
const { Telegraf } = require("telegraf");

const bot = new Telegraf("Ð¢Ð’ÐžÐ™_Ð¢ÐžÐšÐ•Ð_ÐžÐ¢_BOTFATHER");
const app = express();

app.use(express.json());

// Webhook endpoint
app.post("/webhook", (req, res) => {
  bot.handleUpdate(req.body);
  res.sendStatus(200);
});

// ÐšÐ¾Ð¼Ð°Ð½Ð´Ð° /start
bot.start((ctx) => {
  ctx.reply("ÐÐ°Ð¶Ð¼Ð¸ ÐºÐ½Ð¾Ð¿ÐºÑƒ, Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð¸Ð³Ñ€Ð°Ñ‚ÑŒ ðŸ‘‡", {
    reply_markup: {
      keyboard: [
        [
          {
            text: "ðŸŽ® Ð˜Ð³Ñ€Ð°Ñ‚ÑŒ",
            web_app: { url: "https://uid00178.github.io/hippogame/" }
          }
        ]
      ],
      resize_keyboard: true
    }
  });
});

// ÐšÐ¾Ð¼Ð°Ð½Ð´Ð° /play
bot.command("play", (ctx) => {
  ctx.reply("Ð—Ð°Ð¿ÑƒÑÐºÐ°ÑŽ Ð¸Ð³Ñ€Ñƒ ðŸ‘‡", {
    reply_markup: {
      inline_keyboard: [
        [
          {
            text: "Ð˜Ð³Ñ€Ð°Ñ‚ÑŒ ðŸŽ®",
            web_app: { url: "https://uid00178.github.io/hippogame/" }
          }
        ]
      ]
    }
  });
});

const PORT = process.env.PORT || 3000;

// Set webhook
bot.telegram.setWebhook(`https://hippogame-production.up.railway.app/webhook`);

app.listen(PORT, () => {
  console.log(`Server running on port ${PORT}`);
});
